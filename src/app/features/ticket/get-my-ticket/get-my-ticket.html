<div class="page-header">
  <div class="page-title">
    <h1>My Tickets</h1>
    <p *ngIf="!isAgent">Track and manage your support requests</p>
    <p *ngIf="isAgent">You have done a great Job! </p>
  </div>
  
  <button *ngIf="!isAgent" class="btn-create" (click)="goToCreate()">
    <i class="fas fa-plus"></i> Create Ticket
  </button>
</div>

<div *ngIf="loading" class="loading-wrapper">
  <div class="loader"></div>
</div>

<div *ngIf="errorMessage" class="error-banner">
  <i class="fas fa-exclamation-triangle"></i>
  {{ errorMessage }}
</div>

<div class="table-container" *ngIf="!loading && tickets.length > 0">
  <table class="styled-table">
    <thead>
      <tr>
        <th>Ticket ID</th>
        <th>Subject</th>
        <th>Category</th>
        <th>Status</th>
        <th>Created</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let t of tickets" (click)="openTicket(t.ticketId)">
        
        <td>
          <span class="ticket-id">#{{ t.ticketId.substring(0,6) }}</span>
        </td>

        <td>
          <span class="ticket-title">{{ t.title }}</span>
        </td>

        <td>
          <span class="ticket-category">{{ t.category }}</span>
        </td>

        <td>
          <span class="status-pill" [ngClass]="'status-' + t.status">
            {{ t.status.replace('_', ' ') }}
          </span>
        </td>

        <td>
          <span style="color: #718096; font-size: 13px;">
            {{ t.createdAt | date:'mediumDate' }}
          </span>
        </td>

        <td>
          <button class="btn-view">
            <i class="fas fa-chevron-right"></i>
          </button>
        </td>

      </tr>
    </tbody>
  </table>
</div>

<div *ngIf="!loading && tickets.length === 0 && !errorMessage" class="table-container empty-state">
  <div class="empty-icon">
    <i class="far fa-folder-open"></i>
  </div>
  <h3>No Tickets Found</h3>
  <p *ngIf="!isAgent">You haven't submitted any support tickets yet.</p>
  <button *ngIf="!isAgent" class="btn-create" style="margin: 20px auto;" (click)="goToCreate()">
    Submit your first ticket
  </button>
</div>